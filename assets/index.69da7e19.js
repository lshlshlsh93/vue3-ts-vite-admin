import{G as V,o as i,m as w,p as h,h as F,b as k,A as I,a4 as U,J as S,F as L,aR as K,aS as ce,a_ as ie,a$ as pe,aT as fe,a as z,ar as _e,f as c,r as $,ai as N,al as he,M as x,c as X,g as me,bf as ve,b7 as ge,bg as ye,bh as be,u as _,af as Fe,t as M,aU as Ve,bd as Ee,b8 as Ae,P as Z,Q as j,I as Ce,x as De,aX as we,b1 as Be,aZ as ke,K as $e,L as Pe}from"./vendor.4ef58cd9.js";import{_ as T,d as Se,c as Re}from"./index.dced291f.js";import{a as Ue,h as Ie}from"./pageFormFormat.773c1703.js";function Le(e=!1){const a=V(e);function l(){a.value=!0}function t(){a.value=!1}function s(){a.value=!a.value}return[a,l,t,s]}function H(e=!1){const[a,l,t]=Le(e);return[a,l,t]}function Y(e){const a=V([]),l=V(0),[t,s,u]=H(!1),C=e.model?V():V(),r=V({page:1,size:10}),m=async(o={})=>{try{s();const{data:y}=await e.queryAction(o);return a.value=y.records,l.value=y.total,y}catch{}finally{u()}};return{startLoading:t,tableData:a,total:l,searchParams:r,searchRef:C,handleSearch:(o={})=>{r.value={page:r.value.page,size:r.value.size,...o},m(r.value)},handlePageChange:o=>{o.page&&(r.value.page=o.page),o.size&&(r.value.size=o.size),m(r.value)},queryDataAction:m}}function xe(e,a,l,t,s,u){const C=K,r=ce,m=ie,d=pe,v=fe;return i(),w(v,{model:e.modelValue,rules:e.formRules,ref:"formRef","label-width":e.labelWidth,"label-position":"right"},{default:h(()=>[F(d,null,{default:h(()=>[(i(!0),k(L,null,I(e.formItems,o=>(i(),w(m,U(e.colLayout,{key:o.label}),{default:h(()=>[o.hidden?S("",!0):(i(),w(r,{key:0,prop:o.field,label:o.label,style:{width:"100%"}},{default:h(()=>[o.type==="input"||o.type==="password"?(i(),w(C,U({key:0,"model-value":e.modelValue[o.field]},o.otherOption,{placeholder:o.placeholder,"show-password":o.type==="password","onUpdate:modelValue":y=>e.handleValueChange(y,o.field)}),null,16,["model-value","placeholder","show-password","onUpdate:modelValue"])):S("",!0)]),_:2},1032,["prop","label"]))]),_:2},1040))),128))]),_:1})]),_:1},8,["model","rules","label-width"])}const Me=T(Se,[["render",xe]]),ze={class:"dialog-footer"},Oe=$("\u53D6\u6D88"),qe=$("\u786E\u8BA4"),q=z({__name:"pageModel",props:{modelConfig:null,defaultData:null,title:{default:"\u7F16\u8F91"},primaryKey:{default:"id"},loading:{type:Boolean,default:!1}},emits:["edit","add"],setup(e,{expose:a,emit:l}){const t=e,s=V(!1),u=V(),C=V(!1),r=V({});t.modelConfig.formItems.forEach(v=>{v.default&&(r.value[v.field]=v.default)}),a({dialogVisible:C}),_e(()=>t.defaultData,v=>{for(const o of t.modelConfig.formItems)r.value[o.field]=v[o.field]});const m=()=>{var o;const v=(o=u.value)==null?void 0:o.validateForm;v&&v().then(()=>{t.defaultData[t.primaryKey]?l("edit",r.value):l("add",r.value)})},d=()=>{var v;(v=u.value)==null||v.resetForm()};return(v,o)=>{const y=N,B=he;return i(),w(B,{modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=D=>s.value=D),title:t.title,width:"500px",center:"",onClose:d},{footer:h(()=>[c("span",ze,[F(y,{loading:e.loading},{default:h(()=>[Oe]),_:1},8,["loading"]),F(y,{loading:e.loading,type:"primary",onClick:m},{default:h(()=>[qe]),_:1},8,["loading"])])]),default:h(()=>[c("div",null,[F(Me,U({ref_key:"formRef",ref:u},t.modelConfig,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=D=>r.value=D)}),null,16,["modelValue"])])]),_:1},8,["modelValue","title"])}}});function Ke(e={}){e.modal||(e.modal=q);const a=V(),l=V({});return{handleCreate:()=>{a.value&&(l.value={},e.defaultData&&(l.value={...e.defaultData}),a.value.dialogVisible=!0),e.createFn&&e.createFn()},handleUpdate:u=>{a.value&&(l.value=u,a.value.dialogVisible=!0),e.editFn&&e.editFn(u)},pageModalRef:a,formData:l}}function Ne(e={}){let a,l,t;const[s,u,C]=H(!1);e.createAction&&(a=async m=>{try{u();const d=await e.createAction(m);return x.success("\u521B\u5EFA\u6210\u529F"),e.pageModalRef&&e.pageModalRef.value&&(e.pageModalRef.value.dialogVisible=!1),e.callback&&e.callback(),d}catch(d){console.log(d)}finally{C()}}),e.editAction&&(l=async m=>{try{u();const d=await e.editAction(m);return x.success("\u4FEE\u6539\u6210\u529F"),e.pageModalRef&&e.pageModalRef.value&&(e.pageModalRef.value.dialogVisible=!1),e.callback&&e.callback(),d.data}catch(d){console.log(d)}finally{C()}}),e.deleteAction&&(t=async m=>{try{u();const d=await e.deleteAction(m);return x.success("\u5220\u9664\u6210\u529F"),e.callback&&e.callback(),d==null?void 0:d.data}catch(d){console.log(d)}finally{C()}});const r=()=>{};return{createPageDataAction:a||r,updatePageDataAction:l||r,deletePageDataAction:t||r,modalLoading:s}}const J={formItems:[{field:"name",type:"input",label:"\u5E97\u94FA\u540D",placeholder:"\u8BF7\u8F93\u5165\u5E97\u94FA\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E97\u94FA\u540D",trigger:"blur"}]},{field:"phone",type:"input",label:"\u624B\u673A\u53F7",placeholder:"\u8BF7\u8F93\u5165\u5E97\u94FA\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E97\u94FA\u624B\u673A\u53F7",trigger:"blur"},{validator:Te,trigger:"blur"}]},{field:"area",type:"areapicker",label:"\u6240\u5728\u5730\u533A",placeholder:"\u7B5B\u9009\u6240\u5728\u5730\u533A"}],colLayout:{span:24},labelWidth:"80px"};function Te(e,a,l){Number.isInteger(Number(a))?a<=0?l(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u7C7B\u578B")):l():l(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u7C7B\u578B"))}const We={shop:{searchLable:"\u5E97\u94FA\u540D",url:"",valueField:"id",labelField:"name",tableConfig:[{field:"id",title:"\u5E97\u94FAid"},{field:"name",title:"\u5E97\u94FA\u540D"}]}},Ge={class:"page-select"},Je={class:"popper-container"},Qe={class:"search-container"},Xe={class:"search-label"},Ze={class:"table-container"},je={class:"page-container"},He={class:"btn-container"},Ye=$("\u5173\u95ED"),el=$("\u786E\u5B9A"),ll=z({__name:"pageSelect",props:{modelValue:null,placeholder:{default:"\u8BF7\u9009\u62E9"},module:{default:"shop"},multiple:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:a}){const l=e,t=We[l.module],{searchParams:s,handlePageChange:u,handleSearch:C,queryDataAction:r,startLoading:m,tableData:d,total:v}=Y({queryAction:t.url});s.value.enable=1;const o=A=>{u({page:A})},y=A=>{s.value.page=1,C(s.value)},B=X({get(){return l.modelValue},set(A){a("update:modelValue",A)}}),D=V(!1),R=V([]),n=A=>{R.value=A.map(f=>({value:f[t.valueField],label:f[t.labelField]}))},p=()=>{if(D.value)return D.value=!1;d.value.length||C(s.value),l.modelValue||(g.value=[]),D.value=!0},E=V();me(()=>{l.modelValue&&!R.value.length&&(s.value[t.valueField]=l.modelValue,r(s.value).then(A=>{n(A.records),A.records.forEach(f=>{if(l.multiple&&Array.isArray(l.modelValue)){const P=f[t.valueField];l.modelValue.includes(P)&&g.value.push(f)}else f[t.valueField]===l.modelValue&&g.value.push(f)})}))});const g=V([]),ee=A=>g.value.findIndex(f=>f[t.valueField]===A)>=0,le=(A,f)=>{if(A){if(l.multiple)return g.value.push(f);g.value=[f]}else{if(l.multiple){const P=g.value.findIndex(O=>O[t.valueField]===f[t.valueField]);return P>=0&&g.value.splice(P,1)}g.value=[]}},ae=()=>{if(l.multiple)n(g.value),a("update:modelValue",g.value.map(A=>A[t.valueField])),a("change",g.value);else{if(g.value.length>1)return x.warning("\u8BF7\u9009\u62E9\u5355\u4E2A\u6570\u636E");n(g.value),a("update:modelValue",g.value[0][t.valueField]),a("change",g.value[0])}D.value=!1};return(A,f)=>{const P=N,O=K,te=ve,G=ge,oe=ye,ne=Z,ue=j,se=Ce,de=be;return i(),k("div",Ge,[F(se,{visible:D.value,"onUpdate:visible":f[3]||(f[3]=b=>D.value=b),placement:"bottom",width:400},{reference:h(()=>[F(ue,{modelValue:_(B),"onUpdate:modelValue":f[2]||(f[2]=b=>Fe(B)?B.value=b:null),placeholder:e.placeholder,style:{width:"100%"},multiple:e.multiple,onClick:p,"popper-class":"page-select-popper"},{default:h(()=>[(i(!0),k(L,null,I(R.value,b=>(i(),w(ne,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","multiple"])]),default:h(()=>[c("div",Je,[c("div",Qe,[c("span",Xe,M(_(t).searchLable)+"\uFF1A",1),F(O,{size:"small",modelValue:_(s).search,"onUpdate:modelValue":f[0]||(f[0]=b=>_(s).search=b),placeholder:"\u641C\u7D22\u5173\u952E\u8BCD",clearable:"",onClear:y,onKeyup:Ve(y,["enter"])},{append:h(()=>[F(P,{onClick:y})]),_:1},8,["modelValue","onKeyup"])]),c("div",Ze,[Ee((i(),w(_(Ae),{ref_key:"tableRef",ref:E,size:"small","max-height":"250",border:"",data:_(d)},{default:h(()=>[F(G,{width:"55",align:"center"},{default:h(({row:b})=>[F(te,{"model-value":ee(b[_(t).valueField]),onChange:re=>le(re,b)},null,8,["model-value","onChange"])]),_:1}),(i(!0),k(L,null,I(_(t).tableConfig,b=>(i(),w(G,{key:b.field,property:b.field,label:b.title,align:"center","show-overflow-tooltip":""},null,8,["property","label"]))),128))]),_:1},8,["data"])),[[de,_(m)]])]),c("div",je,[F(oe,{"page-size":_(s).size,"current-page":_(s).page,small:"",background:"",layout:"total, prev, pager, next",total:_(v),onCurrentChange:o},null,8,["page-size","current-page","total"])]),c("div",He,[F(P,{size:"small",onClick:f[1]||(f[1]=b=>D.value=!1)},{default:h(()=>[Ye]),_:1}),F(P,{type:"primary",size:"small",onClick:ae},{default:h(()=>[el]),_:1})])])]),_:1},8,["visible"])])}}}),al={class:"page-search"},tl={key:0,class:"title"},ol={class:"data-wrapper"},nl={class:"filter-wrapper clearfix"},ul={class:"label"},sl={class:"form"},dl={class:"btn-item"},rl=$(" \u641C\u7D22 "),cl=$("\u91CD\u7F6E"),il=z({__name:"pageSearch",props:{formItems:{default:()=>[]},title:{type:[String,Boolean]},loading:{type:Boolean,default:!1}},emits:["init","search"],setup(e,{emit:a}){const l=e,t=De(),s={};for(let d of l.formItems)s[d.field]=d.default||"";const u=V({...s});a("init",u.value);const C=()=>{a("search",u.value)},r=()=>{u.value=s,a("search",s)},m=X(()=>{if(l.title)return typeof l.title=="boolean"?t.meta.name:l.title});return(d,v)=>{const o=K,y=Z,B=j,D=Be,R=N;return i(),k("div",al,[l.title?(i(),k("div",tl,M(_(m)),1)):S("",!0),c("div",ol,[we(d.$slots,"data",{},void 0,!0)]),c("div",nl,[(i(!0),k(L,null,I(l.formItems,n=>{var p;return i(),k("div",{class:"search-item",key:n.field},[c("div",ul,M(n.label),1),c("div",sl,[n.type==="input"||n.type==="password"?(i(),w(o,U({key:0,modelValue:u.value[n.field],"onUpdate:modelValue":E=>u.value[n.field]=E},n.otherOption,{placeholder:n.placeholder,"show-password":n.type==="password"}),null,16,["modelValue","onUpdate:modelValue","placeholder","show-password"])):S("",!0),n.type==="select"?(i(),w(B,{key:1,modelValue:u.value[n.field],"onUpdate:modelValue":E=>u.value[n.field]=E,placeholder:n.placeholder,style:{width:"100%"}},{default:h(()=>[(i(!0),k(L,null,I(n.option,E=>(i(),w(y,U(n.otherOption,{key:E.value,label:E.label,value:E.value}),null,16,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):S("",!0),n.type==="datepicker"?(i(),w(D,U({key:2,modelValue:u.value[n.field],"onUpdate:modelValue":E=>u.value[n.field]=E},n.otherOption,{style:{width:"100%"}}),null,16,["modelValue","onUpdate:modelValue"])):S("",!0),n.type==="areapicker"?(i(),w(Re,{key:3,modelValue:u.value[n.field],"onUpdate:modelValue":E=>u.value[n.field]=E,"other-option":n.otherOption,style:{width:"100%"},"filter-city":(p=n.otherOption)==null?void 0:p.filterCity},null,8,["modelValue","onUpdate:modelValue","other-option","filter-city"])):S("",!0),n.type==="pageselect"?(i(),w(ll,U({key:4,style:{width:"100%"},modelValue:u.value[n.field],"onUpdate:modelValue":E=>u.value[n.field]=E,placeholder:n.placeholder},n.otherOption),null,16,["modelValue","onUpdate:modelValue","placeholder"])):S("",!0)])])}),128)),c("div",dl,[F(R,{loading:e.loading,type:"primary",onClick:C},{default:h(()=>[rl]),_:1},8,["loading"]),F(R,{loading:e.loading,onClick:r},{default:h(()=>[cl]),_:1},8,["loading"])])])])}}});const Q=T(il,[["__scopeId","data-v-0a65e33d"]]),W=e=>($e("data-v-744382ac"),e=e(),Pe(),e),pl={class:"data-overview"},fl={class:"item"},_l={class:"value"},hl=$("\u5BB6 "),ml=W(()=>c("div",{class:"label"},"\u7F8E\u53D1\u5206\u5E97",-1)),vl=W(()=>c("div",{class:"item"},[c("div",{class:"value"},[c("span",null,"23"),$("\u4E2A\u5730\u5E02")]),c("div",{class:"label"},"\u904D\u5E03\u8303\u56F4")],-1)),gl=W(()=>c("div",{class:"item"},[c("div",{class:"value"},[c("span",null,"2365987"),$("\u4F4D")]),c("div",{class:"label"},"\u65E5\u63A5\u5F85\u4EBA\u6570")],-1)),yl=z({__name:"index",setup(e){const{searchRef:a,startLoading:l,tableData:t,total:s,handleSearch:u,handlePageChange:C,searchParams:r}=Y({queryAction:"",model:Q}),m=p=>{p=Ue(p),p=Ie(p),u(p)},{handleCreate:d,handleUpdate:v,pageModalRef:o,formData:y}=Ke({modal:q,editFn:p=>{p.district_code?p.area=p.district_code:p.city_code?p.area=p.city_code:p.province_code?p.area=p.province_code:p.area=""}}),{createPageDataAction:B,updatePageDataAction:D,deletePageDataAction:R,modalLoading:n}=Ne({});return(p,E)=>{const g=ke;return i(),w(g,{class:"page-container",shadow:"never"},{default:h(()=>[F(Q,{loading:_(l),title:!0,"form-items":_(J).formItems,onInit:m,onSearch:m},{data:h(()=>[c("div",pl,[c("div",fl,[c("div",_l,[c("span",null,M(_(s)),1),hl]),ml]),vl,gl])]),_:1},8,["loading","form-items"]),F(q,{ref:"","model-config":_(J),defaultData:_(y),loading:_(n),onEdit:_(D),onAdd:_(B)},null,8,["model-config","defaultData","loading","onEdit","onAdd"])]),_:1})}}});const El=T(yl,[["__scopeId","data-v-744382ac"]]);export{El as default};
